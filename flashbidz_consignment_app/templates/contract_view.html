{% extends "base.html" %}

{% block title %}Consignment Contract #{{ contract.id }} – FlashBidz{% endblock %}

{% block content %}

<style>
  .contract-page {
    max-width: 900px;
    margin: 0 auto 40px auto;
    background: #111;
    padding: 24px;
    border-radius: 16px;
  }

  .contract-card {
    background: #fff;
    border-radius: 12px;
    padding: 24px 28px 32px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.35);
    font-size: 14px;
    line-height: 1.5;
  }

  .contract-header-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 18px;
  }

  .brand-mark {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .brand-logo {
    width: 32px;
    height: 32px;
    border-radius: 8px;
    background: linear-gradient(135deg, #e60000, #ff8800);
    display: flex;
    align-items: center;
    justify-content: center;
    color: #fff;
    font-size: 18px;
    font-weight: 800;
  }

  .brand-text {
    font-weight: 800;
    letter-spacing: .04em;
    color: #e60000;
    text-transform: uppercase;
  }

  .status-pill {
    padding: 4px 10px;
    border-radius: 999px;
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: .08em;
    font-weight: 600;
  }
  .status-draft {
    background:#fff7e0;
    color:#8a5a00;
    border:1px solid #f1d38a;
  }
  .status-locked {
    background:#e6fff0;
    color:#0a7a3b;
    border:1px solid #9be0b6;
  }

  .contract-meta {
    display:flex;
    flex-wrap:wrap;
    gap:16px;
    font-size: 12px;
    color:#444;
    margin-bottom: 18px;
  }

  .contract-meta div span.label {
    font-weight:600;
    color:#222;
  }

  .contract-buttons {
    display:flex;
    gap:10px;
    margin-bottom:18px;
    flex-wrap: wrap;
  }

  .btn-ghost {
    border-radius:999px;
    border:1px solid #ddd;
    background:#fafafa;
    padding:5px 14px;
    font-size:12px;
    cursor:pointer;
  }
  .btn-ghost-danger {
    border-color:#e60000;
    color:#e60000;
    background:#fff5f5;
  }
  .btn-ghost-primary {
    border-color:#111;
    color:#111;
  }

  .section-title {
    margin: 22px 0 6px;
    font-size: 15px;
    font-weight: 700;
    color:#111;
    border-bottom: 2px solid #e60000;
    display:inline-block;
    padding-bottom:2px;
  }

  .box {
    border-radius: 8px;
    border:1px solid #eee;
    background:#fcfcfc;
    padding:12px 14px;
    margin-top:6px;
    margin-bottom:8px;
  }

  .items-table {
    width:100%;
    border-collapse: collapse;
    margin-top: 8px;
    font-size: 13px;
  }
  .items-table th,
  .items-table td {
    border:1px solid #eee;
    padding:6px 8px;
  }
  .items-table th {
    background:#111;
    color:#fff;
    text-align:left;
  }

  .totals-row td {
    font-weight:600;
    background:#fafafa;
  }

  .legal-heading {
    font-weight:700;
    margin-top:12px;
    margin-bottom:4px;
    color:#111;
  }

  .signatures {
    display:flex;
    flex-wrap:wrap;
    gap:32px;
    margin-top: 26px;
  }
  .sig-block {
    flex:1 1 260px;
  }
  .sig-line {
    border-bottom:1px solid #333;
    margin-top:40px;
    margin-bottom:4px;
  }
  .muted {
    color:#666;
    font-size: 11px;
  }

  @media print {
    body {
      background:#fff;
    }
    .contract-page {
      margin:0;
      padding:0;
      background:#fff;
    }
    .contract-card {
      box-shadow:none;
      border-radius:0;
      padding:0;
    }
    .contract-buttons,
    header,
    nav {
      display:none !important;
    }
  }
</style>

<div class="contract-page">
  <div class="contract-card">

    <!-- Top bar: logo + status -->
    <div class="contract-header-bar">
      <div class="brand-mark">
        <div class="brand-logo">⚡</div>
        <div>
          <div class="brand-text">FlashBidz LLC</div>
          <div style="font-size:11px;color:#555;">
            51797 County Road 652 · Mattawan, MI 49071
          </div>
        </div>
      </div>

      <div>
        {% if contract.status == 'locked' %}
          <span class="status-pill status-locked">Locked – Ready for Use</span>
        {% else %}
          <span class="status-pill status-draft">Draft – Not Yet Final</span>
        {% endif %}
      </div>
    </div>

    <!-- Contract meta -->
    <div class="contract-meta">
      <div><span class="label">Contract #:</span> {{ contract.id }}</div>
      <div><span class="label">Created:</span> {{ contract.created_at }}</div>
      <div><span class="label">Status:</span> {{ contract.status|title }}</div>
      <div><span class="label">Items on contract:</span> {{ total_items }}</div>
    </div>

    <!-- Buttons (admin only for lock/unlock) -->
    <div class="contract-buttons">
      <button type="button" class="btn-ghost-primary" onclick="window.print()">Print / Save as PDF</button>

      {% if session.get('role','').lower() == 'admin' %}
        {% if contract.status == 'draft' %}
          <form method="post" action="{{ url_for('contract_lock', contract_id=contract.id) }}" style="display:inline;">
            <button class="btn-ghost-primary" type="submit">Lock Contract</button>
          </form>
        {% else %}
          <form method="post" action="{{ url_for('contract_unlock', contract_id=contract.id) }}" style="display:inline;">
            <button class="btn-ghost-danger" type="submit">Unlock for Editing</button>
          </form>
        {% endif %}
      {% endif %}
    </div>

    <!-- Parties -->
    <h2 class="section-title">1. Parties</h2>
    <p>
      This Consignment &amp; Estate Agreement (“Agreement”) is between:
    </p>
    <div class="box">
      <strong>FlashBidz LLC (“Auctioneer” / “Company”)</strong><br>
      51797 County Road 652<br>
      Mattawan, MI 49071<br>
      Phone: {{ get_settings().store_phone or '' }}
    </div>

    <div class="box">
      <strong>Consignor:</strong><br>
      {{ consignor.name }}<br>
      {% if consignor.address_line1 %}
        {{ consignor.address_line1 }}{% if consignor.address_line2 %}, {{ consignor.address_line2 }}{% endif %}<br>
      {% endif %}
      {% if consignor.city or consignor.state or consignor.postal_code %}
        {{ consignor.city }} {{ consignor.state }} {{ consignor.postal_code }}<br>
      {% endif %}
      {% if consignor.phone %}
        Phone: {{ consignor.phone }}<br>
      {% endif %}
      {% if consignor.email %}
        Email: {{ consignor.email }}
      {% endif %}
    </div>
<p class="legal-heading">Authorized Sales Channels</p>
<div class="box">
  <p style="margin:0 0 4px 0;">
    Based on the selections on file for this consignor, FlashBidz is authorized to sell items through
    the following channels:
  </p>
  <ul style="margin:0 0 0 18px;padding:0;">
    {% if consignor.sell_at_auction %}
      <li>Auction – FlashBidz online auctions at 13% commission.</li>
    {% endif %}
    {% if consignor.sell_in_store %}
      <li>In-Store / Local Marketplace – retail / marketplace sales at 25% commission.</li>
    {% endif %}
    {% if consignor.sell_on_ebay %}
      <li>eBay – online sales at 25% commission plus actual eBay fees.</li>
    {% endif %}
    {% if not (consignor.sell_at_auction or consignor.sell_in_store or consignor.sell_on_ebay) %}
      <li><em>No channels currently selected – please update consignor settings.</em></li>
    {% endif %}
  </ul>
</div>
    <!-- Items summary -->
    <h2 class="section-title">2. Inventory Covered by this Agreement</h2>
    <p>
      This Agreement covers the items listed below and any attached schedules or
      inventory sheets. Additional items consigned later may be added to a new
      contract or an addendum at FlashBidz’s discretion.
    </p>

    <table class="items-table">
      <thead>
        <tr>
          <th style="width:90px;">SKU</th>
          <th>Title / Description</th>
          <th style="width:80px;">Ownership</th>
          <th style="width:80px;">Asking</th>
          <th style="width:80px;">Status</th>
        </tr>
      </thead>
      <tbody>
        {% for it in items %}
        <tr>
          <td>{{ it.sku }}</td>
          <td>{{ it.title }}{% if it.notes %} – {{ it.notes }}{% endif %}</td>
          <td>{{ it.ownership|capitalize }}</td>
          <td>
            {% if it.asking_cents %}
              {{ it.asking_cents|money }}
            {% else %}
              –
            {% endif %}
          </td>
          <td>{{ it.status|capitalize }}</td>
        </tr>
        {% endfor %}
        <tr class="totals-row">
          <td colspan="2">Total items on this contract</td>
          <td colspan="3">{{ total_items }}</td>
        </tr>
      </tbody>
    </table>

    <!-- Commission & Fees -->
    <h2 class="section-title">3. Commission &amp; Fees</h2>

    <p class="legal-heading">3.1 Standard Commission Structure</p>
    <div class="box">
      <ul style="margin:0 0 0 18px;padding:0;">
        <li><strong>Online Auction Sales:</strong> FlashBidz retains a
          commission of <strong>13% of the final hammer price</strong> (sale price).
          Any buyer’s premium charged to the buyer is separate and is retained
          entirely by FlashBidz.</li>
        <li><strong>In-Store / Direct Sales:</strong> FlashBidz retains
          <strong>25% of the gross selling price</strong>.</li>
        <li><strong>eBay / Online Marketplace Sales:</strong> FlashBidz retains
          <strong>25% of the gross selling price</strong> <em>plus</em> all actual
          marketplace, payment processing, and shipping-label fees charged
          in connection with that sale.</li>
      </ul>
    </div>

    <p class="legal-heading">3.2 Additional Fees</p>
    <div class="box">
      <ul style="margin:0 0 0 18px;padding:0;">
        <li><strong>Supplies / Special Handling:</strong> FlashBidz may charge
          reasonable fees for packing materials, special handling, testing, or
          cleaning required to prepare items for sale.</li>
        <li><strong>Disposal / Haul-Away:</strong> If FlashBidz is required to
          dispose of unsellable, damaged, or abandoned items, reasonable
          disposal or dump fees may be deducted from the consignor’s proceeds.</li>
      </ul>
    </div>

    <!-- Settlement -->
    <h2 class="section-title">4. Settlement &amp; Payment to Consignor</h2>
    <div class="box">
      <ul style="margin:0 0 0 18px;padding:0;">
        <li>FlashBidz will prepare consignor statements summarizing sold items,
          commissions, fees, and net proceeds.</li>
        <li>Net proceeds due to the consignor will generally be paid
          <strong>within 30 days</strong> after the close of the auction or
          completion of the sale period, provided the buyer has paid in full and
          any applicable return windows have expired.</li>
        <li>Payment method (check, cash, or electronic payment) will be at
          FlashBidz’s discretion unless otherwise agreed in writing.</li>
      </ul>
    </div>

    <!-- Pickup & Storage -->
    <h2 class="section-title">5. Pickup, Storage &amp; Abandonment</h2>

    <p class="legal-heading">5.1 Buyer Pickup (Sold Items)</p>
    <div class="box">
      <p style="margin:0;">
        Buyers are required to pick up purchases within <strong>7 days</strong>
        of the auction close or sale date. After 7 days, FlashBidz may charge
        a storage fee of <strong>$2.00 per item per day</strong>. After
        <strong>14 days</strong>, items are deemed
        <strong>abandoned</strong> and may be resold, donated, or disposed of at
        FlashBidz’s sole discretion, with no further obligation to the buyer or
        consignor. Storage fees may be deducted from consignor proceeds.
      </p>
    </div>

    <p class="legal-heading">5.2 Unsold Consigned Items</p>
    <div class="box">
      <ul style="margin:0 0 0 18px;padding:0;">
        <li>Unsold items may be:
          (a) relisted in a future auction,
          (b) moved to in-store or online marketplace sales, or
          (c) returned to the consignor, donated, or disposed of – at FlashBidz’s
          discretion and consistent with consignor instructions where practical.</li>
        </li>
        
        <li>If the consignor fails to pick up returned items within
            <strong>14 days</strong> after the last scheduled sale for those items
            (or after being notified that the items are ready for pickup), those
            items may be considered <strong>abandoned</strong> and may be
            donated, disposed of, or sold with no further proceeds owed to the
            consignor. FlashBidz is not required to provide further notice before
            taking action on abandoned items.
        </li>
      </ul>
    </div>

    <!-- Condition & Liability -->
    <h2 class="section-title">6. Condition, Representation &amp; Liability</h2>

    <p class="legal-heading">6.1 “As-Is, Where-Is”</p>
    <div class="box">
      <p style="margin:0;">
        All items are sold <strong>“as-is, where-is”</strong> with no warranties,
        guarantees, or returns unless expressly stated in the listing. FlashBidz
        relies on the consignor’s descriptions and information but may edit for
        clarity, grammar, or accuracy.
      </p>
    </div>

    <p class="legal-heading">6.2 Ownership &amp; Authenticity</p>
    <div class="box">
      <ul style="margin:0 0 0 18px;padding:0;">
        <li>The consignor represents that they are the lawful owner of all items,
          free and clear of liens or third-party claims, and have full authority
          to consign them.</li>
        <li>The consignor agrees to indemnify and hold harmless FlashBidz from
          any claims regarding ownership, authenticity, or undisclosed defects
          in the consigned items.</li>
      </ul>
    </div>

    <p class="legal-heading">6.3 Risk of Loss</p>
    <div class="box">
      <p style="margin:0;">
        FlashBidz will take reasonable care in handling, storing, and displaying
        items, but is not an insurer of the consignor’s property. Except in
        cases of gross negligence or intentional misconduct, FlashBidz’s
        liability for loss or damage to any item shall not exceed the
        anticipated net proceeds that would have been payable to the consignor
        if the item had sold at its expected price.
      </p>
    </div>

    <!-- Marketing & Authority -->
    <h2 class="section-title">7. Marketing, Photos &amp; Sale Decisions</h2>
    <div class="box">
      <ul style="margin:0 0 0 18px;padding:0;">
        <li>The consignor authorizes FlashBidz to photograph items, use those
          images and descriptions in marketing, and determine how and where
          items are advertised and sold (auction, in-store, online marketplace,
          bundles, or lots).</li>
        <li>FlashBidz may, in its discretion, set starting bids, group items,
          accept reasonable offers, or discount items to encourage sale,
          provided the overall consignment terms in this Agreement are followed.</li>
        <li>FlashBidz reserves the right to refuse, withdraw, or remove any item
          it deems unsafe, illegal, unsellable, or inconsistent with its
          business policies.</li>
      </ul>
    </div>

    <!-- Term; Entire Agreement -->
    <h2 class="section-title">8. Term &amp; Entire Agreement</h2>
    <div class="box">
      <ul style="margin:0 0 0 18px;padding:0;">
        <li>This Agreement begins on the date signed and continues until all
          items covered are sold, returned, or otherwise disposed of.</li>
        <li>This document, together with FlashBidz’s posted auction Terms &
          Conditions, constitutes the entire agreement between the parties with
          respect to the consigned items and supersedes any prior verbal
          discussions.</li>
        <li>Any changes or special arrangements must be in writing and approved
          by FlashBidz.</li>
      </ul>
    </div>

    <!-- Signatures -->
    <h2 class="section-title">9. Signatures</h2>
    <p class="muted">
      By signing below, the parties acknowledge that they have read, understand,
      and agree to the terms of this Agreement. Electronic or digital acceptance
      (including online checkboxes, typed names, or electronic signatures) shall
      be treated the same as an original handwritten signature.
    </p>

    <div class="signatures">
      <div class="sig-block">
        <div class="sig-line"></div>
        <div><strong>Consignor Signature</strong></div>
        <div class="muted">Printed Name: {{ consignor.name }}</div>
        <div class="muted">Date: __________________________</div>
      </div>
      <div class="sig-block">
        <div class="sig-line"></div>
        <div><strong>FlashBidz LLC Representative</strong></div>
        <div class="muted">Printed Name: __________________________</div>
        <div class="muted">Date: __________________________</div>
      </div>
    </div>

    <p class="muted" style="margin-top:20px;">
      This template is provided for operational use by FlashBidz LLC. It is not
      legal advice. You may wish to have this Agreement reviewed by an attorney
      licensed in your state.
    </p>

  </div>
</div>

{% endblock %}
